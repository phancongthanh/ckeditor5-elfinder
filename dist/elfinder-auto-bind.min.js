(()=>{function e(e){e.id||(e.id="elfinder_"+Math.random());let n="textarea"==e.tagName.toLowerCase(),i=document.getElementById("elfinder-"+e.id);return i||(i=document.createElement("div"),i.id="elfinder-"+e.id,document.body.appendChild(i)),i.style.display="block",$(i).dialogelfinder({modal:!0,title:"File Manager",url:window.connectorUrl||"/el-finder/file-system/connector",autoOpen:!1,height:600,commandsOptions:{getfile:{oncomplete:"close",multiple:n}},getFileCallback:function(i,l){if(n){var o=e.value?e.value.split("\n"):[];i.forEach((e=>{let t=l.convAbsUrl(e.url);o.includes(t)||o.push(t)})),e.value=o.join("\n")}else{let t=l.convAbsUrl(i.url);e.value=t}t(e.id)}}).elfinder("instance")}function t(e){var t=document.getElementById(e),n=document.getElementById(`image-list-${e}`);if(t&&n)if(n.innerHTML="","textarea"==t.tagName.toLowerCase())t.value.split("\n").forEach((function(e){var t=document.createElement("img");t.src=e,t.style.width="100px",n.appendChild(t)}));else{var i=t.value;if(i){var l=document.createElement("img");l.src=i,l.style.width="100px",n.appendChild(l)}}}function n(n){n.id||(n.id="elfinder_"+Math.random());var i=n.id;if(!document.querySelector(`button[for="${i}"]`)){var l=document.createElement("button");l.type="button",l.setAttribute("for",i),l.className="button-upload md-btn md-btn-new md-btn-wave-light",l.textContent="Upload",n.parentNode.insertBefore(l,n.nextSibling);var o=document.createElement("div");o.className="image-list",o.id=`image-list-${i}`,n.parentNode.insertBefore(o,l.nextSibling);let d=e(n);l.addEventListener("click",(function(){let e=d.getUI();e.dialogelfinder("open"),e.trigger("unselectall")})),t(i),n.addEventListener("input",(function(){t(i)}))}}function i(){document.querySelectorAll("input.upload").forEach(n),document.querySelectorAll("textarea.upload").forEach(n)}window.initElFinder=e,window.createUploadElements=n,window.setupElFinders=i,window.autoSetupElFinders=function(){new MutationObserver((function(e){e.forEach((function(e){e.addedNodes.length>0&&i()}))})).observe(document.body,{childList:!0,subtree:!0})}})();